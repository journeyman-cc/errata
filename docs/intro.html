<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>errata</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Errata</span> <span class="project-version">0.1.0</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1  current"><a href="intro.html"><div class="inner"><span>errata</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>cc</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>journeyman</span></div></div></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>errata</span></div></div></li><li class="depth-4 branch"><a href="cc.journeyman.errata.backtrace.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>backtrace</span></div></a></li><li class="depth-4 branch"><a href="cc.journeyman.errata.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-4 branch"><a href="cc.journeyman.errata.html.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>html</span></div></a></li><li class="depth-4 branch"><a href="cc.journeyman.errata.registry.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>registry</span></div></a></li><li class="depth-4"><a href="cc.journeyman.errata.rename.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>rename</span></div></a></li></ul></div><div class="document" id="content"><div class="doc"><div class="markdown"><h1><a href="#errata" name="errata"></a>errata</h1>
<p>A library designed to filter out from Clojure backtraces those frames likely to be of interest to the developer</p>
<h2><a href="#discussion" name="discussion"></a>Discussion</h2>
<p>Clojure backtraces are very hard to read, because they contain many, many ‘noise’ frames resulting from the internal workings of the Clojure compiler, and relatively few frames from the namespaces the developer is actually working with.</p>
<p>What I’m setting out to do here is to produce tools which allow backtraces to be filtered against a list of ‘interesting’ namespaces, in order to present a compact trace showing the propagation of the error through the developer’s own code, and core libraries that code depends on.</p>
<p>As further goals, I hope</p>
<ol>
  <li>Recover the original Clojure function name and namespace name for each call which actually is to a Clojure function (**achieved**);</li>
  <li>Where the source repository for the function is known, provide a link to it as <a href="">Codox</a> does;</li>
  <li>(Stretch goal) provide a web-service to resolve namespaces to source repositories, perhaps by scraping <a href="https://clojars.org">Clojars</a>;</li>
  <li>To provide a REPL within which the user can register ‘interesting’ namespaces, and have all printed backtraces filtered through those namespaces (**achieved**); and</li>
  <li>To produce a <a href="https://github.com/weavejester/hiccup">Hiccup</a> formatted ‘folded’ backtrace, so that when that backtrace is viewed as an HTML page, initially only ‘interesting’ frames are shown, but ‘noise’ areas can be selectively unfolded to allow viewing (**achieved**); and finally</li>
  <li>To allow the user to set a flag in the REPL which, if set, will cause folded backtraces to be automatically opened in browser windows, whenever an uncaught exception propagates back to the REPL; or alternatively</li>
  <li>(Stretch goal) Rwnder the HTML in the nrepl terminal window using NCURSES graphics, much as [Lynx](<a href="https://en.wikipedia.org/wiki/Lynx_(web_browser)">https://en.wikipedia.org/wiki/Lynx_(web_browser)</a>) or <a href="http://w3m.sourceforge.net/">w3m</a> would.</li>
</ol>
<h2><a href="#usage" name="usage"></a>Usage</h2>
<p>At present, the most useful entry point is</p>
<pre><code class="clojure">(show-html-backtrace error namespaces)
(show-html-backtrace error)
(show-html-backtrace)

</code></pre>
<p>Example usage </p>
<pre><code class="clojure">(use 'cc.journeyman.errata.core)

;; an error to demonstrate with.
(def error 
  (try
    (/ 1 0)
    (catch Exception e e)))

;; you can explicitly pass both exception object and list of namespace names
(show-html-backtrace error ["nrepl.middleware"])

;; `namespaces` defaults to those namespace names registered as interesting,
;; so register one (or more)
(register-interesting-ns! "nrepl.middleware")
(show-html-backtrace error)

;; `error` defaults to the current value of `*e`, so this does exactly the same
;; as `(show-html-backtrace *e)`)`.
(show-html-backtrace)

;; you can also show error in the NREPL terminal.
;; you can explicitly pass both exception object and list of namespace names
(summarise-error error ["nrepl.middleware" "clojure.lang.Number"])

;; `namespaces` defaults to registered interesting namespaces, as before.
(register-interesting-ns! "clojure.lang.Number")
(summarise-error error)

;; `error` defaults to the current value of `*e`, so this does exactly the same
;; as `(summarise-error *e)`)`.
(summarise-error)

;; Finally, for convenience working in the REPL, `serr` is a shortcut for 
;; `summarise-error`
(serr)
</code></pre>
<h1><a href="#license" name="license"></a>License</h1>
<p>Copyright © 2021 Simon Brooke</p>
<p>This program and the accompanying materials are made available under the terms of the Eclipse Public License 2.0 which is available at <a href="http://www.eclipse.org/legal/epl-2.0">http://www.eclipse.org/legal/epl-2.0</a>.</p>
<p>This Source Code may also be made available under the following Secondary Licenses when the conditions for such availability set forth in the Eclipse Public License, v. 2.0 are satisfied: GNU General Public License as published by the Free Software Foundation, either version 2 of the License, or (at your option) any later version, with the GNU Classpath Exception which is available at <a href="https://www.gnu.org/software/classpath/license.html">https://www.gnu.org/software/classpath/license.html</a>.</p></div></div></div></body></html>